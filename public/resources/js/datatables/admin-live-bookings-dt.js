/* eslint-disable no-undef */
$(document).ready(() => {
  $('#admin-live-bookings-dt').DataTable({
    ajax: { url: '/bookings/admin-live-bookings', type: 'POST', dataType: 'json', data: (d) => { d._csrf = _csrf } },
    dom: "<'row'<'col-md-6'l><'#features2.col-md-6'Bf>>" + "<'row'<'col-md-6'><'col-md-6'>>" + "<'row'<'col-md-12't>><'row'<'col-md-12'ip>>",
    language: { loadingRecords: 'Bookings will appear here...' },
    deferRender: true,
    columns: [
      { data: null,
        title: 'Action',
        orderable: false,
        defaultContent: '<i>N/A</i>',
        fnCreatedCell: (nTd, sData, oData, iRow, iCol) => { $(nTd).html(`<form method="POST" action="/bookings/admin-edit-booking"><input type="hidden" name="_csrf" value=${_csrf}></input><input type="hidden" name="bookingID" value=${sData.bookingID}></input><button type='submit' name='Submit' class="badge badge-info">Edit</button></form>`) }
      },
      { data: 'collectionLocation', title: 'From:', render: (x) => isProvided(x) },
      { data: 'colFullAdd', title: 'Full Collection Addr:', render: (x) => isProvided(x) },
      { data: 'deliveryLocation', title: 'To:', render: (x) => isProvided(x) },
      { data: 'delFullAdd', title: 'Full Delivery Addr:', render: (x) => isProvided(x) },
      { data: 'createdAt', title: 'Created On:', type: 'datetime-moment', render: (x, t) => adminDateAndTime(x, t) },
      { data: 'paidFor', title: 'Paid:', render: (x) => isRequired(x) },
      { data: 'invoiceSent', title: 'Invoiced?', render: (x) => isRequired(x) },
      { data: 'totalGross', title: 'Tot Gross:', render: (x) => convertNumToGBP(x) },
      { data: 'cusID', title: 'Custo ID:', render: (x) => isProvided(x) },
      { data: 'customersHandlerName', title: 'Custo Handler:', render: (x) => isProvided(x) },
      { data: 'cusInternalRef', title: 'Custo Own Ref:', render: (x) => isProvided(x) },
      { data: 'trailerType', title: 'Trl Type:', render: (x) => isProvided(x) },
      { data: 'numOfTrailers', title: 'Num of Trl\'s:', render: (x) => isProvided(x) },
      { data: 'grossWeightKg', title: 'G-Weight:', render: (x) => { return (x + 'Kg') } },
      { data: 'tailLiftCollection', title: 'T-Lift Col:', render: (x) => isRequired(x) },
      { data: 'tailLiftDelivery', title: 'T-Lift Del:', render: (x) => isRequired(x) },
      { data: 'sheeting', title: 'Sheeting:', render: (x) => isRequired(x) },
      { data: 'goalPosts', title: 'Pins/Posts:', render: (x) => isRequired(x) },
      { data: 'loadDetails', title: 'Load Discr:', render: (x) => isProvided(x) },
      { data: 'extraQuoteInfo', title: 'Quote Notes', render: (x) => isProvided(x) },
      { data: 'collectionRef', title: 'Col Ref:', render: (x) => isProvided(x) },
      { data: 'collectionContact', title: 'Col Contact:', render: (x) => isProvided(x) },
      { data: 'collectionDate', title: 'Col Date:', type: 'datetime-moment', render: (x, t) => adminDate(x, t) },
      { data: 'collectionInstructions', title: 'Col Instructions:', render: (x) => isProvided(x) },
      { data: 'deliveryRef', title: 'Del Ref:', render: (x) => isProvided(x) },
      { data: 'deliveryContact', title: 'Del Contact:', render: (x) => isProvided(x) },
      { data: 'deliveryDate', title: 'Del Date:', type: 'datetime-moment', render: (x, t) => adminDate(x, t) },
      { data: 'deliveryInstructions', title: 'Del Notes:', render: (x) => isProvided(x) },
      { data: 'loadStatus', title: 'Load Status:', render: (x) => isProvided(x) },
      { data: 'haulierHandlersName', title: 'Haulier Handler:', render: (x) => isProvided(x) },
      { data: 'haulierInternalRef', title: 'Haulier Internal Ref:', render: (x) => isProvided(x) },
      { data: 'quotedRate', title: 'Quote Rate:', render: (x) => convertNumToGBP(x) },
      { data: 'totalNet', title: 'Tot Net:', render: (x) => convertNumToGBP(x) },
      { data: 'vatPrice', title: 'VAT:', render: (x) => convertNumToGBP(x) },
      { data: 'updatedAt', title: 'Last Updated:', type: 'datetime-moment', render: (x, t) => adminDateAndTime(x, t) },
      { data: 'hauliersID', title: 'Hauliers ID:', render: (x) => isProvided(x) },
      { data: 'quoteID', title: 'Quote ID:', render: (x) => isProvided(x) },
      { data: 'bookingID', title: 'Booking ID:', render: (x) => isProvided(x) },
      { data: 'enquiryID', title: 'Enquiry ID:', render: (x) => isProvided(x) }
    ],
    'order': [[1, 'desc']]
  })
})
